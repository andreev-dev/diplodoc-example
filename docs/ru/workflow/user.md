# Жизненный цикл Жизненный цикл пользователя

## 1. Параметры жизненного цикла

- **Код жизненного цикла**: user
- **Объект**: User

## 2. Диаграмма состояний

<div style="text-align: center;">
<a href="/images/workflow/diagrams-svg/user.svg" target="_blank">
<img src="/images/workflow/diagrams-svg/user.svg" alt="user" style="max-height: 300px; cursor: pointer;" title="Кликните для увеличения">
</a>
</div>

## 3. Состояния

| Наименование | Код | Описание | Доступные действия |
|--------------|-----|----------|-------------------|
| Ожидает подтверждения e-mail | `await_email_confirmation` | Состояние объекта, ожидающего подтверждения e-mail | Подтверждение регистрации, Отправить повторно ключ подтверждения, Редактировать, Редактировать, Подтверждение редактирования email, Удалить пользователя |
| Активен | `active` | Активное состояние объекта | Подтверждение регистрации, Изменить пароль, Подтверждение редактирования email, Редактировать, Заблокировать, Сбросить пароль, Сбросить пароль, Редактировать, Заблокировать, Редактировать, Заблокировать, Удалить пользователя |
| Заблокирован | `blocked` | Заблокированное состояние объекта | Изменить пароль, Редактировать, Разблокировать, Удалить пользователя, Сбросить пароль, Сбросить пароль, Редактировать, Разблокировать, Редактировать, Разблокировать |
| Ожидает подтверждения оператором | `await_operator_confirmation` | Состояние объекта, ожидающего подтверждения оператором | Удалить пользователя, Подтвердить, Отклонить, Список запросов на добавление пользователей |
| Отклонен оператором | `rejected_by_operator` | Отклоненное оператором состояние | Редактировать, Удалить, Отправить повторно запрос на добавление пользователя, Удалить пользователя |
| Удален | `deleted` | Удаленное состояние объекта | *Не определены* |

## 4. Действия

| Наименование | Код | Описание | Тип |
|--------------|-----|----------|-----|
| Авторизация | `login` |  | Глобальное |
| Авторизация с помощью электронной подписи | `login-ecp` |  | Глобальное |
| Восстановление пароля | `recovery-password` |  | Глобальное |
| Главная страница | `index` |  | Глобальное |
| Мой профиль | `my-profile` |  | Глобальное |
| Подтверждение почты и смена пароля | `confirm-by-token` |  | Глобальное |
| Редактирование моего профиля | `edit-my-profile` |  | Глобальное |
| Реестр операторов | `operator-list` |  | Глобальное |
| Реестр пользователей | `user-list` |  | Глобальное |
| Смена пароля | `change-password-by-token` |  | Глобальное |
| Смена пароля | `profile-password` |  | Глобальное |
| Добавить пользователя | `employee-add` | Добавить пользователя | Инициализирующие |
| Добавить пользователя зарегистрированной организации | `registrationByOperator` | Добавить пользователя зарегистрированной организации | Инициализирующие |
| Добавление оператора | `operator-add` | Добавить оператора | Инициализирующие |
| Зарегистрироваться | `register` |  | Инициализирующие |
| Заблокировать | `user-block` |  | Действие состояния |
| Заблокировать | `operator-block` |  | Действие состояния |
| Заблокировать | `employee-block` |  | Действие состояния |
| Изменить пароль | `change-password` |  | Действие состояния |
| Отклонить | `employee-reject` |  | Действие состояния |
| Отправить повторно запрос на добавление пользователя | `employee-request-repeat` |  | Действие состояния |
| Отправить повторно ключ подтверждения | `resend-token` |  | Действие состояния |
| Подтвердить | `employee-approve` |  | Действие состояния |
| Подтверждение регистрации | `confirm` |  | Действие состояния |
| Подтверждение редактирования email | `confirm-email` |  | Действие состояния |
| Разблокировать | `user-unblock` |  | Действие состояния |
| Разблокировать | `operator-unblock` |  | Действие состояния |
| Разблокировать | `employee-unblock` |  | Действие состояния |
| Редактировать | `operator-edit` |  | Действие состояния |
| Редактировать | `user-edit` |  | Действие состояния |
| Редактировать | `employee-edit` |  | Действие состояния |
| Сбросить пароль | `user-reset-password` |  | Действие состояния |
| Сбросить пароль | `operator-reset-password` |  | Действие состояния |
| Список запросов на добавление пользователей | `employee-request-list` |  | Действие состояния |
| Удалить | `employee-delete` |  | Действие состояния |
| Удалить пользователя | `user-delete` |  | Действие состояния |

## 5. Матрица доступности действий

| Действие / Статус | Ожидает подтверждения e-mail | Активен | Заблокирован | Ожидает подтверждения оператором | Отклонен оператором | Удален |
|:---------|:---------:|:---------:|:---------:|:---------:|:---------:|:---------:|
| **Сбросить пароль (`user-reset-password`)** |  | ✅ | ✅ |  |  |  |
| **Редактировать (`operator-edit`)** |  | ✅ | ✅ |  |  |  |
| **Редактировать (`user-edit`)** | ✅ | ✅ | ✅ |  |  |  |
| **Изменить пароль (`change-password`)** |  | ✅ | ✅ |  |  |  |
| **Редактировать (`employee-edit`)** | ✅ | ✅ | ✅ |  | ✅ |  |
| **Сбросить пароль (`operator-reset-password`)** |  | ✅ | ✅ |  |  |  |
| **Отправить повторно ключ подтверждения (`resend-token`)** | ✅ |  |  |  |  |  |
| **Подтвердить (`employee-approve`)** |  |  |  | ✅ |  |  |
| **Отклонить (`employee-reject`)** |  |  |  | ✅ |  |  |
| **Список запросов на добавление пользователей (`employee-request-list`)** |  |  |  | ✅ |  |  |
| **Заблокировать (`user-block`)** |  | ✅ |  |  |  |  |
| **Разблокировать (`user-unblock`)** |  |  | ✅ |  |  |  |
| **Разблокировать (`operator-unblock`)** |  |  | ✅ |  |  |  |
| **Удалить пользователя (`user-delete`)** | ✅ | ✅ | ✅ | ✅ | ✅ |  |
| **Подтверждение регистрации (`confirm`)** | ✅ | ✅ |  |  |  |  |
| **Подтверждение редактирования email (`confirm-email`)** | ✅ | ✅ |  |  |  |  |
| **Заблокировать (`operator-block`)** |  | ✅ |  |  |  |  |
| **Заблокировать (`employee-block`)** |  | ✅ |  |  |  |  |
| **Разблокировать (`employee-unblock`)** |  |  | ✅ |  |  |  |
| **Удалить (`employee-delete`)** |  |  |  |  | ✅ |  |
| **Отправить повторно запрос на добавление пользователя (`employee-request-repeat`)** |  |  |  |  | ✅ |  |

